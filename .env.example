# ========================================
# Forex Companion Backend Environment Template
# Hosting: Railway
# Frontend: Vercel
# Auth: Firebase Auth
# Transactional Email: Brevo
# ========================================

# -------------------------------
# Runtime
# -------------------------------
DEBUG=true

# -------------------------------
# Frontend redirect base (required in prod)
# Must be HTTPS in production.
# -------------------------------
FRONTEND_APP_URL=https://forex-frontend-dusky.vercel.app
EMAIL_VERIFICATION_CONTINUE_URL=https://forex-frontend-dusky.vercel.app/verify
PASSWORD_RESET_CONTINUE_URL=https://forex-frontend-dusky.vercel.app/reset
FRONTEND_USE_HASH_ROUTES=true

# Optional extra host allowlist for redirects (comma-separated)
# Keep localhost entries only for local development.
REDIRECT_ALLOWLIST=https://forex-frontend-dusky.vercel.app,http://localhost:8080,http://127.0.0.1:8080

# -------------------------------
# CORS (backend)
# In production, set only your Vercel domain(s)
# -------------------------------
CORS_ALLOW_ALL=false
CORS_ALLOW_LOCALHOST=true
CORS_ORIGINS=https://forex-frontend-dusky.vercel.app,http://localhost:8080,http://127.0.0.1:8080
CORS_ORIGIN_REGEX=^https?://(localhost|127[.]0[.]0[.]1)(:[0-9]+)?$
CORS_MAX_AGE_SECONDS=86400

# -------------------------------
# Auth endpoint rate limiting
# -------------------------------
AUTH_RATE_LIMIT_ENABLED=true
AUTH_RATE_LIMIT_MAX=10
AUTH_RATE_LIMIT_WINDOW_SECONDS=300
AUTH_LINK_TIMEOUT_SECONDS=20

# Optional global API rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX=120
RATE_LIMIT_WINDOW_SECONDS=60

# -------------------------------
# Security hardening
# -------------------------------
ENABLE_HSTS=true
ENABLE_CSP=true
MAX_REQUEST_BODY_BYTES=1048576
# ALLOWED_HOSTS=127.0.0.1,localhost,api.your-domain.com

# -------------------------------
# Firebase Admin + Auth
# -------------------------------
FIREBASE_PROJECT_ID=forexcompanion-e5a28
# Choose one credential method:
# FIREBASE_SERVICE_ACCOUNT_PATH=/path/to/service-account.json
# FIREBASE_SERVICE_ACCOUNT_JSON_B64=<base64-encoded-json>

# Needed for REST fallback in auth link generation
FIREBASE_API_KEY=replace_with_firebase_web_api_key

# Optional strict boot requirement
REQUIRE_FIREBASE=false

# Startup check: ensure FRONTEND_APP_URL host exists in Firebase Auth authorized domains.
FIREBASE_AUTH_DOMAIN_CHECK_ENABLED=true
# In production this should stay true to fail fast on bad Firebase redirect config.
FIREBASE_AUTH_DOMAIN_CHECK_FAIL_FAST=true
FIREBASE_AUTH_DOMAIN_CHECK_TIMEOUT_SECONDS=10

# -------------------------------
# Email provider (Brevo preferred)
# -------------------------------
EMAIL_PROVIDER=brevo

BREVO_API_KEY=replace_with_brevo_api_key
BREVO_FROM_EMAIL=forexcompanionauto@gmail.com
BREVO_FROM_NAME=Forex Companion
BREVO_REPLY_TO=forexcompanionauto@gmail.com

# Optional fallback: Mailjet
# MAILJET_API_KEY=replace_with_mailjet_api_key
# MAILJET_SECRET_KEY=replace_with_mailjet_secret
# MAILJET_FROM_EMAIL=verified_sender@example.com
# MAILJET_FROM_NAME=Forex Companion
# MAILJET_REPLY_TO=support@example.com

# Optional fallback: SMTP
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=user@example.com
# SMTP_PASS=app-password
# SMTP_FROM=user@example.com
# SMTP_TLS=true

# -------------------------------
# Optional dev identity bridge
# -------------------------------
ALLOW_DEV_USER_ID=true
# DEV_USER_LOCALHOST_ONLY=true
# DEV_AUTH_SHARED_SECRET=change_me

# -------------------------------
# Optional websocket/data features
# -------------------------------
FOREX_STREAM_ENABLED=true

# -------------------------------
# Optional notifications connectors
# -------------------------------
# TELEGRAM_BOT_TOKEN=
# TELEGRAM_DEFAULT_CHAT_ID=
# DISCORD_WEBHOOK_URL=
# SMS_WEBHOOK_URL=
# WHATSAPP_WEBHOOK_URL=
# NOTIFICATION_WEBHOOK_URL=
